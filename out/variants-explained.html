<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="data:;base64,iVBORw0KGgo="/><meta name="author" content="Jimmy Miller"/><link rel="alternate" type="application/rss+xml" title="jimmyhmiller.github.io" href="feed.xml"/><title>Variants Explained</title><meta name="next-head-count" content="6"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-779b41245c009d2a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9a4e0bcfd9f9bf48.js" defer=""></script><script src="/_next/static/chunks/346-54adb587a188464b.js" defer=""></script><script src="/_next/static/chunks/854-585071c317c86ef6.js" defer=""></script><script src="/_next/static/chunks/pages/variants-explained-5aa667e1d0c4c578.js" defer=""></script><script src="/_next/static/C2m2AnFEEWh5NFVJQM23D/_buildManifest.js" defer=""></script><script src="/_next/static/C2m2AnFEEWh5NFVJQM23D/_ssgManifest.js" defer=""></script><script src="/_next/static/C2m2AnFEEWh5NFVJQM23D/_middlewareManifest.js" defer=""></script><style id="__jsx-4dc580444c2ee173">body{font-family:helvetica,sans-serif;color:#333;line-height:1.5}a{color:#333}</style></head><body><div id="__next" data-reactroot=""><div style="margin:0 auto;max-width:700px"><div style="position:relative"><div style="position:absolute;right:0;top:0"><a style="text-decoration:none" href="/"><h1 style="color:#999">Jimmy Miller</h1></a></div></div><div style="padding-top:70px"><h1>Variants Explained</h1><p>Imagine you have the following request for a product you are building:</p><blockquote style="padding-left:20px;margin:0;margin-left:20px;border-left:0.25em solid #dfe2e5">Users should be able to login using the following methods:<ul><li>Username and Password</li><li>Phone Number</li><li>Facebook Login</li></ul></blockquote><p>As you are building this application you have to think about how to represent these user credentials. It might look something like this:</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#93a1a1">// Username and Password auth</span>
userCredentials<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#586e75">{</span>
  username<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#2aa198">&quot;test&quot;</span><span class="token" style="color:#586e75">,</span>
  password<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#2aa198">&quot;password&quot;</span>
<span class="token" style="color:#586e75">}</span>

<span class="token" style="color:#93a1a1">// phoneNumber auth</span>
userCredentials<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#586e75">{</span>
  phoneNumber<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#2aa198">&quot;555-867-5309&quot;</span>
<span class="token" style="color:#586e75">}</span>

<span class="token" style="color:#93a1a1">// Facebook Login</span>
userCredentials<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#586e75">{</span>
  token<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#2aa198">&quot;VGhpcyBpcyBzdXBlciBzZWNyZXQ=&quot;</span> 
<span class="token" style="color:#586e75">}</span>
</code></pre><p>There is a problem with the above way of representing this scenario. Imagine we needed to write a function that uses these user credentials. We have to make sure to handle every single case.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#859900">function</span> <span class="token" style="color:#b58900">handleAuth</span><span class="token" style="color:#586e75">(</span><span class="token parameter">userCredentials</span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#586e75">{</span>
  <span class="token" style="color:#859900">if</span> <span class="token" style="color:#586e75">(</span>userCredentials<span class="token" style="color:#586e75">.</span>username <span class="token" style="color:#cb4b16">&amp;&amp;</span> userCredentials<span class="token" style="color:#586e75">.</span>password<span class="token" style="color:#586e75">)</span> <span class="token" style="color:#586e75">{</span>
  <span class="token" style="color:#93a1a1">// do stuff with username login</span>
  <span class="token" style="color:#586e75">}</span> <span class="token" style="color:#859900">else</span> <span class="token" style="color:#859900">if</span> <span class="token" style="color:#586e75">(</span>userCredentials<span class="token" style="color:#586e75">.</span>phoneNumber<span class="token" style="color:#586e75">)</span> <span class="token" style="color:#586e75">{</span>
      <span class="token" style="color:#93a1a1">// do stuff with phone number login</span>
  <span class="token" style="color:#586e75">}</span> <span class="token" style="color:#859900">else</span> <span class="token" style="color:#859900">if</span> <span class="token" style="color:#586e75">(</span>userCredentials<span class="token" style="color:#586e75">.</span>token<span class="token" style="color:#586e75">)</span> <span class="token" style="color:#586e75">{</span>
      <span class="token" style="color:#93a1a1">// do stuff with facebook login</span>
  <span class="token" style="color:#586e75">}</span> <span class="token" style="color:#859900">else</span> <span class="token" style="color:#586e75">{</span>
      <span class="token" style="color:#93a1a1">// handle unknown scenario</span>
  <span class="token" style="color:#586e75">}</span>
<span class="token" style="color:#586e75">}</span>
</code></pre><p>This code may seem good as far as it goes, in fact, it even handles malformed data gracefully. Now imagine that our requirements change, we now need to handle third-party username and password requests as well. We decide to model this in the obvious way.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">userCredentials<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#586e75">{</span>
  username<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#2aa198">&quot;test&quot;</span><span class="token" style="color:#586e75">,</span>
  password<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#2aa198">&quot;password&quot;</span><span class="token" style="color:#586e75">,</span>
  thirdParty<span class="token" style="color:#586e75">:</span> <span class="token" style="color:#2aa198">&quot;SomeOtherBusiness&quot;</span>
<span class="token" style="color:#586e75">}</span>
</code></pre><p>Unfortunately, now our code breaks, but not by throwing a nice error, it breaks subtly. We will try to use third-party usernames and passwords for our own login system and since they have a username and password we will mistake them for first-party logins.</p><p>In javascript, there aren&#x27;t too many great solutions to this. One obvious one is to create a class for each of different userCredential type. Then for any function, we want to implement on our different types we implement a method in that class. That is how a Java developer may have solved this problem. That approach has its upsides and downsides, but rather than dive into those, let&#x27;s look at a different approach, one that isn&#x27;t supported by javascript. Since it isn&#x27;t supported by javascript we will have to choose some other language. But rather than choose an existing language, let&#x27;s just make up our own and imagine what it might be like to solve this problem in it.</p><h2>Variants: An Example</h2><p>The essence of our requirements is that we need to support different methods of login. Users may login this way <em>or</em> that way <em>or</em> some other way. We need a way to represent <strong>or</strong> in our data model. Variants allow us to do exactly that. Let&#x27;s first look at a simple example of a variant.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#859900">data</span> <span class="token" style="color:#268bd2">Color</span> <span class="token" style="color:#cb4b16">=</span> <span class="token" style="color:#268bd2">Green</span> <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Red</span> <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Blue</span>
</code></pre><p>Here we have a variant with three choices of colors. In our world, a color can only be green, red, or blue. No other colors are available to us. What we need to do now is write a function that returns true if it is passed the <em>best</em> color.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">fn bestColor <span class="token" style="color:#586e75">{</span>
  <span class="token parameter">Green</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#268bd2">true</span>
  <span class="token parameter">Red</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#268bd2">false</span>
  <span class="token parameter">Blue</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#268bd2">false</span>
<span class="token" style="color:#586e75">}</span>
<span class="token" style="color:#b58900">bestColor</span><span class="token" style="color:#586e75">(</span>Red<span class="token" style="color:#586e75">)</span>
<span class="token" style="color:#93a1a1">// false</span>

<span class="token" style="color:#b58900">bestColor</span><span class="token" style="color:#586e75">(</span>Green<span class="token" style="color:#586e75">)</span>
<span class="token" style="color:#93a1a1">// true</span>
</code></pre><p>This function is rather straightforward. We pattern match on the argument of the function to determine what was passed in. This allows us to express in a very concise way each case and what its output should be. Variants combined with pattern matching allow for very expressive, explicit code.</p><p>Simple variants like color are just like enums in other languages, but variants are much more useful when they can take arguments as well.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#859900">data</span> <span class="token" style="color:#268bd2">UserCredentials</span> <span class="token" style="color:#cb4b16">=</span> <span class="token" style="color:#268bd2">FirstParty</span><span class="token" style="color:#586e75">(</span><span class="token hvariable">username</span><span class="token" style="color:#586e75">,</span> <span class="token hvariable">password</span><span class="token" style="color:#586e75">)</span>
                     <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Phone</span><span class="token" style="color:#586e75">(</span><span class="token hvariable">phoneNumber</span><span class="token" style="color:#586e75">)</span>
                     <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Facebook</span><span class="token" style="color:#586e75">(</span><span class="token hvariable">token</span><span class="token" style="color:#586e75">)</span>
                     <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">ThirdParty</span><span class="token" style="color:#586e75">(</span><span class="token hvariable">username</span><span class="token" style="color:#586e75">,</span> <span class="token hvariable">password</span><span class="token" style="color:#586e75">,</span> <span class="token hvariable">thirdParty</span><span class="token" style="color:#586e75">)</span>
</code></pre><p>Here we have our login problem fully specified. Each case is represented as a data type and because of that, we can write a much less error-prone function for dealing with each case.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">fn handleAuth <span class="token" style="color:#586e75">{</span>
  <span class="token" style="color:#b58900">FirstParty</span><span class="token" style="color:#586e75">(</span><span class="token parameter">username<span class="token" style="color:#586e75">,</span> password</span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#93a1a1">// do stuff with username login</span>
  <span class="token" style="color:#b58900">Phone</span><span class="token" style="color:#586e75">(</span><span class="token parameter">phoneNumber</span> <span class="token" style="color:#586e75">)</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#93a1a1">// do stuff with phone number login</span>
  <span class="token" style="color:#b58900">Facebook</span><span class="token" style="color:#586e75">(</span><span class="token parameter">token</span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#93a1a1">// do stuff with facebook login</span>
  <span class="token" style="color:#b58900">ThirdParty</span><span class="token" style="color:#586e75">(</span><span class="token parameter">username<span class="token" style="color:#586e75">,</span> password<span class="token" style="color:#586e75">,</span> thirdparty</span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#93a1a1">// do stuff with thirdParty login</span>
  <span class="token parameter">otherwise</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#93a1a1">// handle unknown scenario</span>
<span class="token" style="color:#586e75">}</span>
</code></pre><p>Not only is our function less error-prone, but it is also much easier to understand. Variants allow our code to be self-documenting. Each case is named and handled explicitly leading us to think precisely about each scenario. Since our imaginary language is dynamically typed, we do need to handle the <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">otherwise</code> case (imagine someone passed in a number instead), but if it were statically typed we could be guaranteed that nothing other than those variants would be passed.</p><h2>Using Variants to Solve Problems</h2><p>Variants are not just limited to concrete scenarios like the login above. They can be quite a bit more generic and that can give us more power. Let&#x27;s look at a few generic variants that can be used to tackle common and difficult problems in programming.</p><h2>Nulls</h2><p>Null (undefined as well) is one of the most frustrating things to work with. Expressing nulls checks leads to verbose code. Code isn&#x27;t actually about the problem we are trying to solve. Variants offer an alternative to nulls, called the Maybe type.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#859900">data</span> <span class="token" style="color:#268bd2">Maybe</span> <span class="token" style="color:#cb4b16">=</span> <span class="token" style="color:#268bd2">Nothing</span> <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Something</span><span class="token" style="color:#586e75">(</span><span class="token hvariable">thing</span><span class="token" style="color:#586e75">)</span>
</code></pre><p>The definition above may seem a bit strange if this is your first time encountering it. What it says is that there are two cases we need to consider, when we have nothing (the null case) and when we have something (the non-null case). We can use this by pattern matching.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">fn tryToGetUserId <span class="token" style="color:#586e75">{</span>
  <span class="token" style="color:#b58900">Something</span><span class="token" style="color:#586e75">(</span><span class="token parameter">user</span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#b58900">Something</span><span class="token" style="color:#586e75">(</span><span class="token" style="color:#b58900">getId</span><span class="token" style="color:#586e75">(</span>user<span class="token" style="color:#586e75">)</span><span class="token" style="color:#586e75">)</span>
  <span class="token parameter">Nothing</span> <span class="token" style="color:#cb4b16">=&gt;</span> Nothing
<span class="token" style="color:#586e75">}</span>
</code></pre><p>The tryToGetUserId handles the case when we don&#x27;t have a user id by pattern matching on <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Nothing</code> and returning<!-- --> <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Nothing</code>. If however we get something (a user) then we get the id of that user and return <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Something</code> which contains a user.</p><p>The tryToGetUserId handles the case when we don&#x27;t have a user id by pattern matching on <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Nothing</code> and returning <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Nothing</code>. If however we get something (a user) then we get the id of that user and return <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Something</code>which contains a user.</p><p>As it stands, this isn&#x27;t that much better than null, but when combined with simple functions, this variant becomes infinitely more useful.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">fn map <span class="token" style="color:#586e75">{</span>
  <span class="token" style="color:#586e75">(</span><span class="token parameter">f<span class="token" style="color:#586e75">,</span> <span class="token" style="color:#b58900">Something</span><span class="token" style="color:#586e75">(</span>x<span class="token" style="color:#586e75">)</span></span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#cb4b16">=&gt;</span> <span class="token" style="color:#b58900">Something</span><span class="token" style="color:#586e75">(</span><span class="token" style="color:#b58900">f</span><span class="token" style="color:#586e75">(</span>x<span class="token" style="color:#586e75">)</span><span class="token" style="color:#586e75">)</span>
  <span class="token" style="color:#586e75">(</span><span class="token parameter">f<span class="token" style="color:#586e75">,</span> Nothing</span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#cb4b16">=&gt;</span> Nothing
<span class="token" style="color:#586e75">}</span>
</code></pre><p>Here we have map. You may be familiar with map with it comes to lists and if so, map for <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Maybe</code> is very similar. As you can see from the function definition, map applies f only if we have <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Something</code>, if not it returns<code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Nothing</code>. Using map we can rewrite our tryToGetUserId function.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">fn <span class="token" style="color:#b58900">tryToGetUserId</span><span class="token" style="color:#586e75">(</span><span class="token parameter">maybeUser</span><span class="token" style="color:#586e75">)</span> <span class="token" style="color:#586e75">{</span>
  <span class="token" style="color:#b58900">map</span><span class="token" style="color:#586e75">(</span>getId<span class="token" style="color:#586e75">,</span> maybeUser<span class="token" style="color:#586e75">)</span>
<span class="token" style="color:#586e75">}</span>
</code></pre><p>Using map extracts out all the pattern matching and does it for us. This same pattern can work for other variants. <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">map</code> is much more general than just lists.</p><pre style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em;background-color:#fff"><code style="color:#657b83;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#859900">data</span> <span class="token" style="color:#268bd2">Either</span> <span class="token" style="color:#cb4b16">=</span> <span class="token" style="color:#268bd2">Error</span> <span class="token hvariable">e</span> <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Success</span> <span class="token hvariable">s</span>
<span class="token" style="color:#859900">data</span> <span class="token" style="color:#268bd2">List</span> <span class="token" style="color:#cb4b16">=</span> <span class="token" style="color:#268bd2">Nil</span> <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Cons</span> <span class="token hvariable">x</span> <span class="token" style="color:#2aa198">tail</span>
<span class="token" style="color:#859900">data</span> <span class="token" style="color:#268bd2">Tree</span> <span class="token" style="color:#cb4b16">=</span> <span class="token" style="color:#268bd2">Leaf</span> <span class="token" style="color:#cb4b16">|</span> <span class="token" style="color:#268bd2">Node</span> <span class="token hvariable">left</span> <span class="token hvariable">x</span> <span class="token hvariable">right</span>
</code></pre><p>For each of these structures, there is a sensible map definition. <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">Either</code>allows us to handle errors and only apply the function if we are not in an error state, mapping over a <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">List</code> applies the function to each element, and mapping over a tree applies the function to each node, recursing through the tree.</p><h2>Conclusion</h2><p>Variants are an extremely expressive way to state the assumptions behind our code. They force us to be explicit and handle cases individually. Yet, they also give a means of abstraction, a point at which we can define common interfaces and ignored the particularities underneath. In future posts we will take up this notion in more depth, showing how <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">protocols</code>when combined with <code style="background-color:rgba(27,31,35,0.05);padding:0.2em 0.4em;border-radius:3px;font-family:Monaco, monospace;font-size:13px;white-space:nowrap">variants</code> can bring our language even more power.</p></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/variants-explained","query":{},"buildId":"C2m2AnFEEWh5NFVJQM23D","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>